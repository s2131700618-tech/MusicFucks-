local P = game:GetService("Players").LocalPlayer
local RS = game:GetService("RunService")
local PG = P:WaitForChild("PlayerGui")

-- ðŸ›‘ 1. æ¸…ç†èˆŠç‰ˆç’°å¢ƒ
local function clear()
    for _, v in pairs(PG:GetChildren()) do
        if v.Name == "UltraV6_Final_REAL" then v:Destroy() end
    end
    if P:FindFirstChild("UltraSnd") then P.UltraSnd:Destroy() end
end
clear()

-- ðŸ”Š è²éŸ³ç‰©ä»¶
local sound = Instance.new("Sound", P)
sound.Name = "UltraSnd"

-- ðŸ–¼ï¸ UI ä»‹é¢
local sg = Instance.new("ScreenGui", PG)
sg.Name = "UltraV6_Final_REAL"
sg.ResetOnSpawn = false
sg.DisplayOrder = 999 

local frame = Instance.new("Frame", sg)
frame.Size = UDim2.new(0, 360, 0, 320)
frame.Position = UDim2.new(0.5, -180, 0.5, -160)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.Active, frame.Draggable = true, true
Instance.new("UICorner", frame)

-- â¬› æ¨™é¡Œå€åŸŸ (åŠ å…¥å½©è™¹ UIGradient)
local bar = Instance.new("Frame", frame)
bar.Size = UDim2.new(1, 0, 0, 55)
bar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
Instance.new("UICorner", bar)

local title = Instance.new("TextLabel", bar)
title.Size, title.BackgroundTransparency = UDim2.new(1, 0, 1, 0), 1
title.Text = "Ultra éŸ³æ¨‚æŽ§åˆ¶å™¨ V6.2"
title.TextColor3, title.Font, title.TextSize = Color3.new(1, 1, 1), Enum.Font.GothamBold, 28
title.ZIndex = 25

-- âœ¨ å½©è™¹ç‰¹æ•ˆè…³æœ¬
local grad = Instance.new("UIGradient", title)
local phases = {
    {L = Color3.fromRGB(255, 30, 30), R = Color3.fromRGB(255, 150, 0)},
    {L = Color3.fromRGB(255, 230, 0), R = Color3.fromRGB(50, 255, 50)},
    {L = Color3.fromRGB(0, 255, 200), R = Color3.fromRGB(0, 150, 255)},
    {L = Color3.fromRGB(180, 0, 255), R = Color3.fromRGB(255, 0, 150)},
}

task.spawn(function()
    local s, p = 1, 0
    while sg.Parent do
        p = p + 0.04
        if p >= 1 then p = 0 s = (s % #phases) + 1 end
        local n = (s % #phases) + 1
        grad.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, phases[s].L:Lerp(phases[n].L, p)),
            ColorSequenceKeypoint.new(1, phases[s].R:Lerp(phases[n].R, p))
        })
        RS.RenderStepped:Wait()
    end
end)

-- ðŸ› ï¸ è¼¸å…¥æ¡†å·¥å» 
local function createInp(txt, pos, def)
    local l = Instance.new("TextLabel", frame)
    l.Size, l.Position = UDim2.new(0, 85, 0, 40), UDim2.new(0, 15, 0, pos)
    l.Text, l.TextColor3, l.BackgroundTransparency = txt, Color3.new(1,1,1), 1
    l.Font, l.TextXAlignment, l.TextSize = Enum.Font.GothamBold, Enum.TextXAlignment.Right, 22
    l.ZIndex = 20
    
    local b = Instance.new("TextBox", frame)
    b.Size, b.Position = UDim2.new(0, 230, 0, 40), UDim2.new(0, 110, 0, pos)
    b.Text, b.BackgroundColor3, b.TextColor3 = def, Color3.fromRGB(45,45,45), Color3.new(1,1,1)
    b.ClearTextOnFocus, b.TextSize = false, 22
    b.ZIndex = 20
    Instance.new("UICorner", b)
    return b
end

local idBox = createInp("ID:", 65, "")
local volBox = createInp("éŸ³é‡:", 115, "1")
local spdBox = createInp("é€Ÿåº¦:", 165, "1")

-- ðŸ”„ ã€æ ¸å¿ƒæŽ§åˆ¶é‚è¼¯ã€‘
local isLooping = true
local isManualStop = true 

-- ðŸ”˜ æŒ‰éˆ•å·¥å» 
local function makeBtn(txt, pos, col)
    local b = Instance.new("TextButton", frame)
    b.Size, b.Position = UDim2.new(0.9, 0, 0, 45), UDim2.new(0.05, 0, 0, pos)
    b.BackgroundColor3 = col
    b.Text, b.TextColor3 = txt, Color3.new(1,1,1)
    b.Font, b.TextSize = Enum.Font.GothamBold, 22
    b.ZIndex = 20
    Instance.new("UICorner", b)
    return b
end

-- å¾ªç’°æŒ‰éˆ•
local loopBtn = makeBtn("ðŸ”„ å¾ªç’°æ’­æ”¾: é–‹å•Ÿ", 215, Color3.fromRGB(40, 110, 40))
loopBtn.MouseButton1Click:Connect(function()
    isLooping = not isLooping
    loopBtn.Text = isLooping and "ðŸ”„ å¾ªç’°æ’­æ”¾: é–‹å•Ÿ" or "âŒ å¾ªç’°æ’­æ”¾: é—œé–‰"
    loopBtn.BackgroundColor3 = isLooping and Color3.fromRGB(40, 110, 40) or Color3.fromRGB(110, 40, 40)
end)

-- æ’­æ”¾æŒ‰éˆ•
local playBtn = makeBtn("â–¶ï¸ æ’­æ”¾éŸ³æ¨‚", 265, Color3.fromRGB(0, 110, 220))
playBtn.MouseButton1Click:Connect(function()
    if sound.IsPlaying then 
        isManualStop = true 
        sound:Stop()
        playBtn.Text = "â–¶ï¸ æ’­æ”¾éŸ³æ¨‚"
        playBtn.BackgroundColor3 = Color3.fromRGB(0, 110, 220)
    else
        local id = idBox.Text:match("%d+")
        if id then 
            isManualStop = false 
            sound.SoundId = "rbxassetid://"..id 
            sound:Play() 
            playBtn.Text = "â¹ï¸ åœæ­¢æ’­æ”¾"
            playBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        end
    end
end)

-- âš™ï¸ èƒŒæ™¯ç›£æŽ§ (ç„¡ç¸«å¾ªç’°)
task.spawn(function()
    RS.Heartbeat:Connect(function()
        if not sg.Parent then return end
        pcall(function()
            if sound.IsPlaying then
                sound.Volume = tonumber(volBox.Text) or 1
                sound.PlaybackSpeed = tonumber(spdBox.Text) or 1
                if isLooping and sound.TimeLength > 0 then
                    if (sound.TimeLength - sound.TimePosition) < 0.15 then
                        sound.TimePosition = 0
                    end
                end
            elseif isLooping and not isManualStop and sound.SoundId ~= "" then
                sound:Play()
            end
        end)
    end)
end)

-- ðŸŽµ MF|I/O åˆ‡æ›
local open = Instance.new("TextButton", sg)
open.Size, open.Position = UDim2.new(0, 110, 0, 50), UDim2.new(0.85, 0, 0.1, 0)
open.BackgroundColor3 = Color3.new(0,0,0)
open.Text, open.TextColor3 = "MF|I/O", Color3.new(1,1,1)
open.Font, open.TextSize = Enum.Font.GothamBold, 24
open.Active, open.Draggable, open.ZIndex = true, true, 1000
Instance.new("UICorner", open)
open.MouseButton1Click:Connect(function() frame.Visible = not frame.Visible end)
