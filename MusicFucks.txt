-- ğŸš€ ä¿®æ­£å›æ­¸ç‰ˆï¼šæŒ‰éˆ•é‡ç¾ + å››éšæ®µæµå…‰ + å®‰å…¨é–
local Player = game:GetService("Players").LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local RunService = game:GetService("RunService")

-- 0. å¼·åˆ¶æ¸…ç†èˆŠ UI
if PlayerGui:FindFirstChild("MusicControl_FinalFix") then 
    PlayerGui.MusicControl_FinalFix:Destroy() 
end

local sound = Player:FindFirstChild("FinalSound") or Instance.new("Sound")
sound.Name = "FinalSound"
sound.Looped = true
sound.Parent = Player

local sg = Instance.new("ScreenGui", PlayerGui)
sg.Name = "MusicControl_FinalFix"
sg.ResetOnSpawn = false
sg.DisplayOrder = 100000

-- --- ä¸»é¢æ¿ ---
local frame = Instance.new("Frame", sg)
frame.Size = UDim2.new(0, 360, 0, 280) -- é«˜åº¦ç¨å¾®å¢åŠ ä¸€é»ï¼Œç¢ºä¿æŒ‰éˆ•æœ‰ç©ºé–“
frame.Position = UDim2.new(0.5, -180, 0.5, -140)
frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Visible = true 
Instance.new("UICorner", frame)

-- ğŸŒˆ æ¨™é¡Œåˆ—
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 40)
title.Text = "Ultra éŸ³æ¨‚æ§åˆ¶å™¨ V6"
title.TextSize = 24
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
title.BorderSizePixel = 0
local tCorner = Instance.new("UICorner", title)

local gradient = Instance.new("UIGradient", title)
local phases = {
    {Left = Color3.fromRGB(255, 165, 0), Right = Color3.fromRGB(255, 0, 0)},   -- 1. å·¦æ©™å³ç´…
    {Left = Color3.fromRGB(255, 255, 0), Right = Color3.fromRGB(255, 165, 0)}, -- 2. å·¦é»ƒå³æ©™
    {Left = Color3.fromRGB(0, 255, 120), Right = Color3.fromRGB(0, 120, 255)}, -- 3. å·¦ç¶ å³è—
    {Left = Color3.fromRGB(0, 255, 255), Right = Color3.fromRGB(170, 0, 255)}, -- 4. å·¦é’å³ç´«
}

task.spawn(function()
    local step, progress = 1, 0
    while true do
        progress = progress + 0.08
        if progress >= 1 then progress = 0 step = (step % #phases) + 1 end
        local nextStep = (step % #phases) + 1
        gradient.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, phases[step].Left:Lerp(phases[nextStep].Left, progress)),
            ColorSequenceKeypoint.new(1, phases[step].Right:Lerp(phases[nextStep].Right, progress))
        })
        RunService.RenderStepped:Wait()
    end
end)

-- ğŸ› ï¸ è¼¸å…¥æ¡†ç”Ÿæˆ
local function createInput(name, pos, default)
    local label = Instance.new("TextLabel", frame)
    label.Size = UDim2.new(0, 60, 0, 30)
    label.Position = UDim2.new(0, 15, 0, pos)
    label.Text = name
    label.TextColor3 = Color3.fromRGB(180, 180, 180)
    label.BackgroundTransparency = 1
    
    local box = Instance.new("TextBox", frame)
    box.Size = UDim2.new(0, 240, 0, 30)
    box.Position = UDim2.new(0, 85, 0, pos)
    box.Text = default
    box.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    box.TextColor3 = Color3.fromRGB(255, 255, 255)
    box.ClearTextOnFocus = false
    Instance.new("UICorner", box)
    return box
end

local idBox = createInput("ID:", 55, "")
local volBox = createInput("éŸ³é‡:", 95, "1")
local spdBox = createInput("é€Ÿåº¦:", 135, "1")

-- ğŸ”„ å¾ªç’°æŒ‰éˆ• (é‡æ–°æ­¸ä½)
local loopBtn = Instance.new("TextButton", frame)
loopBtn.Size = UDim2.new(0.9, 0, 0, 35)
loopBtn.Position = UDim2.new(0.05, 0, 0, 180) -- èª¿æ•´ä½ç½®
loopBtn.BackgroundColor3 = Color3.fromRGB(40, 120, 40)
loopBtn.Text = "ğŸ”„ å¾ªç’°æ’­æ”¾: é–‹å•Ÿ"
loopBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
loopBtn.Font = Enum.Font.GothamBold
Instance.new("UICorner", loopBtn)

-- â–¶ï¸ æ’­æ”¾æŒ‰éˆ•
local playBtn = Instance.new("TextButton", frame)
playBtn.Size = UDim2.new(0.9, 0, 0, 40)
playBtn.Position = UDim2.new(0.05, 0, 0, 225)
playBtn.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
playBtn.Text = "â–¶ï¸ æ’­æ”¾ / åœæ­¢"
playBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
playBtn.Font = Enum.Font.GothamBold
Instance.new("UICorner", playBtn)

-- 3. åŠŸèƒ½åŒæ­¥èˆ‡é–‹é—œé‚è¼¯
local function sync()
    sound.Volume = math.clamp(tonumber(volBox.Text) or 1, 0, 10) 
    sound.PlaybackSpeed = math.clamp(tonumber(spdBox.Text) or 1, 0, 10)
end

volBox:GetPropertyChangedSignal("Text"):Connect(sync)
spdBox:GetPropertyChangedSignal("Text"):Connect(sync)

loopBtn.Activated:Connect(function()
    sound.Looped = not sound.Looped
    loopBtn.Text = sound.Looped and "ğŸ”„ å¾ªç’°æ’­æ”¾: é–‹å•Ÿ" or "âŒ å¾ªç’°æ’­æ”¾: é—œé–‰"
    loopBtn.BackgroundColor3 = sound.Looped and Color3.fromRGB(40, 120, 40) or Color3.fromRGB(120, 40, 40)
end)

playBtn.Activated:Connect(function()
    if sound.IsPlaying then sound:Stop() else
        local id = idBox.Text:match("%d+")
        if id then sound.SoundId = "rbxassetid://"..id sync() sound:Play() end
    end
end)

-- 4. å·¦å´é–‹é—œæŒ‰éˆ•
local openBtn = Instance.new("TextButton", sg)
openBtn.Size = UDim2.new(0, 50, 0, 50)
openBtn.Position = UDim2.new(0, 10, 0.5, -25)
openBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
openBtn.BackgroundTransparency = 0.4
openBtn.Text = "ğŸµ"
openBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
openBtn.TextSize = 30
openBtn.ZIndex = 2000000 
Instance.new("UICorner", openBtn)

openBtn.Activated:Connect(function() frame.Visible = not frame.Visible end)
